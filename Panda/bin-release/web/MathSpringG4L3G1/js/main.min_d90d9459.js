var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{c(n.next(e))}catch(t){r(t)}}function o(e){try{c(n["throw"](e))}catch(t){r(t)}}function c(e){e.done?s(e.value):new i(function(t){t(e.value)}).then(a,o)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(s)throw new TypeError("Generator is already executing.");for(;c;)try{if(s=1,r&&(a=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){c.label=i[1];break}if(6===i[0]&&c.label<a[1]){c.label=a[1],a=i;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(i);break}a[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(n){i=[6,n],r=0}finally{s=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?n(s):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Index=function(e){function t(){var t=e.call(this)||this;return t.file={dom:"panda",dragonbonesData:"xiongmao_ske_json",textureData1:"xiongmao_tex_json",texture1:"xiongmao_tex_png",name:"pandaPlay",count:1},t.huoAnimate={dom:"bomb",dragonbonesData:"dianhuo_ske_json",textureData1:"dianhuo_tex_json",texture1:"dianhuo_tex_png",name:"dianhuo",count:3},t.bombAinamate={dom:"bombGroup",dragonbonesData:"baozha01_ske_json",textureData1:"baozha01_tex_json",texture1:"baozha01_tex_png",name:"bomp",count:1},t.stream={dom:"panda",dragonbonesData:"liulei_ske_json",textureData1:"liulei_tex_json",texture1:"liulei_tex_png",name:"liulei",count:-1},t.over={dom:"overs",dragonbonesData:"yanhua01_ske_json",textureData1:"yanhua01_tex_json",texture1:"yanhua01_tex_png",name:"yanhua",count:-1},t.sunNum=1,t.clickCount=1,t.clickImageArr=[],t.clickImagePosArr=[],t.resultArr=[["A33"],["A53","C51"],["A73","C42","C22"],["C63","C42","C22"]],t.isResult=[],t.imgArr=["luobo_png","nangua_png","wosun_png","xigua_png","yumi_png"],t.isMusic=!0,t.panda_bj=RES.getRes("panda_bj_mp3"),t.panda_click=RES.getRes("panda_click_mp3"),t.panda_chi=RES.getRes("panda_chi_mp3"),t.panda_error=RES.getRes("panda_error_mp3"),t.panda_go=RES.getRes("panda_go_mp3"),t.panda_sub1=RES.getRes("panda_sub1_mp3"),t.panda_sub2=RES.getRes("panda_sub2_mp3"),t.panda_sub3=RES.getRes("panda_sub3_mp3"),t.panda_sub4=RES.getRes("panda_sub4_mp3"),t.panda_bz=RES.getRes("panda_bz_mp3"),t.skinName="IndexSkin",t}return __extends(t,e),t.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),this.skinName="IndexSkin"},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.music.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicFun,this),this.reset.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resetFun,this),this.gameOver.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resetFun,this),this.subject.addEventListener(egret.TouchEvent.TOUCH_TAP,this.subjectFun,this),this.hint.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.hint.visible=!1},this),this.rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickResult,this),this.assemble.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickResult,this),this.shiwu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShiwuFun,this),this.keep.addEventListener(egret.TouchEvent.TOUCH_TAP,this.initialise,this),this.keepOn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.initialise,this),this.revise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.result.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resultFun,this),this.resultMask.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.resultMask.visible=!1},this),this.clickStart.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.endStart.visible=!1,t.start()},this)},t.prototype.start=function(){this.sunNum=1,this.gameOver.visible=!1,this.music_bj=this.panda_bj.play(0,-1),this.cursorFun(),this.initialise()},t.prototype.initialise=function(){var e=this;console.log(this.sunNum),this.playMusic("panda_sub"+this.sunNum),this.isResult=[],this.keepMask.visible=!1,this.keep.visible=!1,this.rank.touchChildren=!0,this.assemble.touchChildren=!0,this.shiwu.touchChildren=!0,this.subject.source="timu"+this.sunNum+"_png",this.digit.source="xiamian"+this.sunNum+"_png",this.resultImg.source="daan"+this.sunNum+"_png",this.pandas.source="pandaImg_png",this.pandas.visible=!0,this.resultImg.visible=!1,this.revise.visible=!1;for(var t=0;t<this.rank.$children.length;t++)this.sunNum-1==t?(this.rank.$children[t].visible=!0,this.assemble.$children[t].visible=!0,this.dataGroup.$children[t].visible=!0):(this.rank.$children[t].visible=!1,this.assemble.$children[t].visible=!1,this.dataGroup.$children[t].visible=!1),this.panzi.$children[t].visible=!1,this.shiwu.$children[t].visible=!1;this.clickImageArr.map(function(t,i){t.x=e.clickImagePosArr[i].x,t.y=e.clickImagePosArr[i].y,t.visible=!0})},t.prototype.subjectFun=function(){this.playMusic("panda_click"),this.hint.visible=!0,this.tipSub.source="fangda"+this.sunNum+"_png"},t.prototype.resultFun=function(){this.playMusic("panda_click"),this.resultMask.visible=!0,this.tipResult.source="xiti"+this.sunNum+"_png"},t.prototype.clickResult=function(e){var t=this;if("group"!=e.target.name){this.playMusic("panda_click"),this.rank.touchChildren=!1,this.assemble.touchChildren=!1;var i=this.rank.$children[this.sunNum-1].$children.length;this.clickImageArr.push(e.target),this.clickImagePosArr.push({x:e.target.x,y:e.target.y}),this.isResult.push(e.target.source.split("_")[0]);var n=this.dataGroup.$children[this.sunNum-1].$children[this.clickCount-1],s=this.dataGroup.x+n.x-e.target.parent.x-e.target.parent.parent.x+(n.width-e.target.width)/2,r=this.dataGroup.y+n.y-e.target.parent.y-e.target.parent.parent.y+(n.height-e.target.height)/2;egret.Tween.get(e.target).to({x:s,y:r},500).wait(100).call(function(){1==t.sunNum&&(t.mc.x=1050,t.mc.y=930),t.clickCount>=i?(t.clickCount=1,t.isSuccessFun()):(t.clickCount++,t.rank.touchChildren=!0,t.assemble.touchChildren=!0,t.revise.visible=!0)},this)}},t.prototype.clickShiwuFun=function(e){var t=this;if("group"!=e.target.name){1==this.sunNum&&this.removeChild(this.mc),this.playMusic("panda_click");var i=e.target;this.shiwu.touchChildren=!1,this.clickImageArr.push(e.target),this.clickImagePosArr.push({x:e.target.x,y:e.target.y});var n=960-(e.target.parent.x+e.target.parent.parent.x)-e.target.width/2,s=700-(e.target.parent.y+e.target.parent.parent.y)-e.target.height/2;this.animationFun(this.file),this.playMusic("panda_chi"),egret.Tween.get(e.target).to({x:n,y:s},300).wait(100).call(function(){t.pandas.visible=!1,i.visible=!1},this)}},t.prototype.isSuccessFun=function(){console.log(this.isResult.sort()),console.log(this.resultArr[this.sunNum-1].sort());var e=!1;this.revise.visible=!1;for(var t=0;t<this.isResult.length;t++){var i=this.isResult.sort()[t]==this.resultArr[this.sunNum-1].sort()[t];if(!i){e=i;break}e=i}console.log(e),i?this.successFun():this.errorFun()},t.prototype.successFun=function(){this.shiwu.touchEnabled=!0,this.resultImg.visible=!0;for(var e=0;e<this.panzi.$children.length;e++)this.sunNum-1==e?(this.panzi.$children[e].visible=!0,this.shiwu.$children[e].visible=!0):(this.panzi.$children[e].visible=!1,this.shiwu.$children[e].visible=!1)},t.prototype.errorFun=function(){var e=this;egret.Tween.get(this.bomb).to({y:740},500).call(function(){e.animationFun(e.huoAnimate)})},t.prototype.cursorFun=function(e,t){void 0===e&&(e=200),void 0===t&&(t=400),this.mc&&this.mc.parent&&this.removeChild(this.mc);var i=RES.getRes("shouzhi_json"),n=RES.getRes("shouzhi_png"),s=new egret.MovieClipDataFactory(i,n);this.mc=new egret.MovieClip(s.generateMovieClipData("shouzhi")),this.addChild(this.mc),this.mc.play(-1),this.mc.x=e,this.mc.y=t},t.prototype.animationFun=function(e){var t=this,i=RES.getRes(e.dragonbonesData),n=RES.getRes(e.textureData1),s=RES.getRes(e.texture1),r=new dragonBones.EgretFactory;r.parseDragonBonesData(i),r.parseTextureAtlasData(n,s);var a=r.buildArmatureDisplay(e.name);return e.dom?this[e.dom].addChild(a):this.addChild(a),"pandaPlay"==e.name?(a.y=30,a.scaleX=2,a.scaleY=2):"dianhuo"==e.name?(a.x=190,a.y=10,a.scaleX=2,a.scaleY=2):"bomp"==e.name?(a.scaleX=2,a.scaleY=2,this.playMusic("panda_bz"),setTimeout(function(){t.pandas.source="pandaImgError_png"},500)):"liulei"==e.name?(a.y=-100,a.scaleX=2,a.scaleY=2):"yanhua"==e.name&&(a.scaleX=2.5,a.scaleY=2.5),a.animation.gotoAndPlayByFrame(e.name,1,e.count),a.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.dom?t[e.dom].removeChild(a):t.removeChild(a),"pandaPlay"==e.name?(t.pandas.visible=!0,t.shiwu.touchChildren=!0,t.clickCount>=t["shiwu"+t.sunNum].$children.length?(t.clickCount=1,t.sunNum>=4?(t.pandas.visible=!1,t.gameOver.visible=!0,t.animationFun(t.stream),t.animationFun(t.over)):(t.sunNum++,t.keepMask.visible=!0,t.playMusic("panda_go"))):t.clickCount++):"dianhuo"==e.name?(t.animationFun(t.bombAinamate),t.bomb.y=1085):"bomp"==e.name&&(t.keep.visible=!0,t.playMusic("panda_error"))},this),a},t.prototype.reviseFun=function(){var e=this;if(this.clickCount>1){this.playMusic("panda_click");var t=this.clickImageArr.length-1,i=this.clickImagePosArr[t].x,n=this.clickImagePosArr[t].y;egret.Tween.get(this.clickImageArr[t]).to({x:i,y:n},300).call(function(){e.clickImageArr.splice(t,1),e.clickImagePosArr.splice(t,1),e.clickCount--,e.clickCount<=1&&(e.revise.visible=!1)})}},t.prototype.musicFun=function(){this.isMusic?(this.music_bj.stop(),this.isMusic=!1,this.music.source="music_close_png"):(this.music_bj=this.panda_bj.play(0,-1),this.isMusic=!0,this.music.source="music_png")},t.prototype.resetFun=function(){window.location.reload()},t.prototype.playMusic=function(e,t){return void 0===t&&(t=1),this.racTipMusic&&this.racTipMusic.stop(),this.racTipMusic=this[e].play(0,t),this.racTipMusic},t}(eui.Component);__reflect(Index.prototype,"Index",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.size=80,this.textField.width=1920,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="正在加载..."+Math.floor(e/t*100)+"%"},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=i.sent(),this.startAnimation(e),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return t=i.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return i.sent(),this.stage.removeChild(e),[3,5];case 4:return t=i.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,i){var n=new eui.Theme("resource/default.thm.json",e.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){var e=new Index;this.addChild(e)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.startAnimation=function(e){var t=this,i=new egret.HtmlTextParser,n=e.map(function(e){return i.parse(e)}),s=this.textfield,r=-1,a=function(){r++,r>=n.length&&(r=0);var e=n[r];s.textFlow=e;var i=egret.Tween.get(s);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(a,t)};a()},t.prototype.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function s(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var o=e.split("/");o.pop();var c=o.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(n,generateJSON.paths[e])},this):RES.getResByUrl(c,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){t.call(n,generateJSON.paths[e])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Keyset=function(e){function t(t,i,n){var s=e.call(this)||this;return s.skinName="KeysetSkin",s.cacl=t,s.x=0,s.y=0,console.log(i,n),s.keySetGroup.x=i,s.keySetGroup.y=n,s}return __extends(t,e),t.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);for(var t=0;10>t;t++)this["key"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickKeyFun,this);this.cacl.clickLabel.text="",this.keyRevise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.keyOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.RectBj.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this)},t.prototype.clickKeyFun=function(e){var t=e.target.source.split("_")[0];this.cacl.clickLabel.text.length<8&&(this.cacl.clickLabel.text+=t.split("key")[1])},t.prototype.reviseFun=function(e){this.cacl.clickLabel.text=""},t.prototype.submitFun=function(e){""!=this.cacl.clickLabel.text?this.cacl.clickLabel.text=parseInt(this.cacl.clickLabel.text)+"":this.cacl.clickLabel.text="输入",this.cacl.removeChild(this)},t}(eui.Component);__reflect(Keyset.prototype,"Keyset",["eui.UIComponent","egret.DisplayObject"]);