var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(s,n){function o(t){try{u(r.next(t))}catch(e){n(e)}}function a(t){try{u(r["throw"](t))}catch(e){n(e)}}function u(t){t.done?s(t.value):new i(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(s)throw new TypeError("Generator is already executing.");for(;u;)try{if(s=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(o=u.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(r){i=[6,r],n=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,n,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function r(r){e.call(i,r,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?r(s):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),this.startAnimation(t),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var r=new eui.Theme("resource/default.thm.json",t.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=new Racing;this.addChild(t)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,r=t.map(function(t){return i.parse(t)}),s=this.textfield,n=-1,o=function(){n++,n>=r.length&&(n=0);var t=r[n];s.textFlow=t;var i=egret.Tween.get(s);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(o,e)};o()},e.prototype.onButtonClick=function(t){var e=new eui.Panel;e.title="Title",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Racing=function(t){function e(){var e=t.call(this)||this;return e.setInputArr=[["国内品牌","国外品牌"],["学生","故事书"],["现在小东","4年前小东"]],e.resultArr=[["5x+2","x","5x+2","200","33","167","33"],["5x","11","8x","4","5","5","36"],["3x-x","10","5","9"]],e.submitArr=[[],[],[]],e.particleArr=[],e.overAnimationArr=[],e.egretFactory=dragonBones.EgretFactory.factory,e.rac_bj=RES.getRes("rac_bj_mp3"),e.rac_ok=RES.getRes("rac_ok_mp3"),e.rac_go=RES.getRes("rac_go_mp3"),e.rac_start_fire=RES.getRes("rac_start_fire_mp3"),e.rac_go_stop=RES.getRes("rac_go_stop_mp3"),e.rac_fete=RES.getRes("rac_fete_mp3"),e.rac_error=RES.getRes("rac_error_mp3"),e.rac_sub_1=RES.getRes("rac_sub_1_mp3"),e.rac_sub_2=RES.getRes("rac_sub_2_mp3"),e.rac_sub_3=RES.getRes("rac_sub_3_mp3"),e.isMusic=!0,e.skinName="RacingSkin",e.addEventListener(egret.Event.ENTER_FRAME,function(){dragonBones.WorldClock.clock.advanceTime(.03)},e),e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.tipGroup.touchChildren=!1,this.openStart.visible=!0,this.submit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.previous.addEventListener(egret.TouchEvent.TOUCH_TAP,this.previousFun,this),this.next.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextFun,this),this.options.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setOptionFun,this),this.racLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.labelFun,this),this.closeMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.recommence,this),this.music.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicFun,this),this.result.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.tipGroup.visible=!0},this),this.tipGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.tipGroup.visible=!1},this),this.revise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.startpic.addEventListener(egret.TouchEvent.TOUCH_TAP,this.start,this),this.startpic.addEventListener(egret.TouchEvent.TOUCH_TAP,this.start,this)},e.prototype.start=function(){this.subjectNum=1,this.tipGroup.visible=!1,this.openStart.visible=!1,this.switchSub(),this.music_bj=this.rac_bj.play(0,-1)},e.prototype.previousFun=function(){this.next.visible=!0,this.subjectNum--,this.switchSub(),this.subjectNum<=1&&(this.previous.visible=!1)},e.prototype.nextFun=function(){this.previous.visible=!0,this.subjectNum++,this.switchSub(),this.subjectNum>=3&&(this.next.visible=!1)},e.prototype.switchSub=function(){this.subject.source="subject"+this.subjectNum+"_png",this.col1.source="col_"+this.subjectNum+"_1_png",this.col2.source="col_"+this.subjectNum+"_2_png",this.col3.source="col_"+this.subjectNum+"_3_png",this.col4.source="col_"+this.subjectNum+"_4_png",this.option1.source="option_"+this.subjectNum+"_1_png",this.option2.source="option_"+this.subjectNum+"_2_png",this.resultTip.source="tip"+this.subjectNum+"_png";for(var t=1;4>t;t++)this.subjectNum==t?this["racLabel"+t].visible=!0:this["racLabel"+t].visible=!1;this.reviseLabelText()},e.prototype.reviseLabelText=function(){for(var t=0;t<this["racLabel"+this.subjectNum].$children.length;t++)this["racLabel"+this.subjectNum].$children[t].text="输入";this.setInput.text="点击下面按钮",this.playMusic("rac_sub_"+this.subjectNum),this.removeParticle()},e.prototype.setOptionFun=function(t){if("group"!=t.target.name){var e=t.target.source.split("_").reverse()[1];this.setInput.text=this.setInputArr[this.subjectNum-1][e-1]}},e.prototype.labelFun=function(t){if(t.target.type){this.clickLabel=t.target;var e=this.racLabel.x+t.target.x,i=this.racLabel.y+t.target.y;this.addChild(new keySet(this,e-230,i-200))}},e.prototype.fireAnimation=function(t,e,i){this.particleArr[i]&&this["rac"+(i+1)].removeChild(this.particleArr[i]);var t=RES.getRes(t),e=RES.getRes(e),r=new particle.GravityParticleSystem(t,e);this.particleArr[i]=r,this["rac"+(i+1)].addChildAt(r,0),r.x=30,r.y=40,r.start(-1)},e.prototype.overAnimation=function(t,e,i,r){void 0===i&&(i=900),void 0===r&&(r=500);var t=RES.getRes(t),e=RES.getRes(e),s=new particle.GravityParticleSystem(t,e);this.overAnimationArr.push(s),this.addChild(s),s.x=i,s.y=r,s.start(-1)},e.prototype.mistAnimation=function(t){var e=RES.getRes("heiyan01_json"),i=RES.getRes("heiyan01_png"),r=new egret.MovieClipDataFactory(e,i),s=new egret.MovieClip(r.generateMovieClipData("heiyan"));this["rac"+(t+1)].addChildAt(s,0),s.play(4),s.x=-50,s.y=-15,s.addEventListener(egret.Event.COMPLETE,function(){this["rac"+(t+1)].removeChild(s)},this)},e.prototype.pokeAnimation=function(t){this.armature&&this.gameover.removeChild(this.armature.getDisplay()),console.log(t);var e=RES.getRes(t.dragonbonesData),i=RES.getRes(t.textureData1),r=RES.getRes(t.texture1);this.egretFactory.parseDragonBonesData(e),this.egretFactory.parseTextureAtlasData(i,r),this.armature=this.egretFactory.buildArmature(t.name);var s=this.armature.getDisplay();this.gameover.addChild(s),s.x=1e3,s.y=500,this.armature.animation.gotoAndPlayByFrame(t.name,1,1).timeScale=1,dragonBones.WorldClock.clock.add(this.armature),this.armature.addEventListener(dragonBones.EventObject.COMPLETE,function(t){this.overAnimation("xingguang01_png","xingguang01_json",1e3,400),this.overAnimation("xingguang01_png","xingguang01_json",800,650),this.overAnimation("xingguang02_png","xingguang02_json"),this.playMusic("rac_fete",-1),this.musicFun()},this)},e.prototype.submitFun=function(){switch(this.playMusic("rac_ok"),this.subjectNum){case 1:this.result1();break;case 2:this.result2();break;case 3:this.result3()}this.commitFun()},e.prototype.result1=function(){var t=this["racLabel"+this.subjectNum].$children,e=this.resultArr[this.subjectNum-1],i=t[1].text==e[1]&&t[2].text==e[2],r=t[1].text==e[2]&&t[2].text==e[1];"国外品牌"==this.setInput.text&&t[0].text==e[0]?this.submitArr[this.subjectNum-1][0]=!0:this.submitArr[this.subjectNum-1][0]=!1,(i||r)&&t[3].text==e[3]?this.submitArr[this.subjectNum-1][1]=!0:this.submitArr[this.subjectNum-1][1]=!1,t[4].text==e[4]?this.submitArr[this.subjectNum-1][2]=!0:this.submitArr[this.subjectNum-1][2]=!1,t[5].text==e[5]&&t[6].text==e[6]?this.submitArr[this.subjectNum-1][3]=!0:this.submitArr[this.subjectNum-1][3]=!1},e.prototype.result2=function(){var t=this["racLabel"+this.subjectNum].$children,e=this.resultArr[this.subjectNum-1],i=t[0].text==e[0]&&t[1].text==e[1],r=t[0].text==e[1]&&t[1].text==e[0];"学生"==this.setInput.text?this.submitArr[this.subjectNum-1][0]=!0:this.submitArr[this.subjectNum-1][0]=!1,(i||r)&&t[2].text==e[2]&&t[3].text==e[3]?this.submitArr[this.subjectNum-1][1]=!0:this.submitArr[this.subjectNum-1][1]=!1,t[4].text==e[4]?this.submitArr[this.subjectNum-1][2]=!0:this.submitArr[this.subjectNum-1][2]=!1,t[5].text==e[5]&&t[6].text==e[6]?this.submitArr[this.subjectNum-1][3]=!0:this.submitArr[this.subjectNum-1][3]=!1},e.prototype.result3=function(){var t=this["racLabel"+this.subjectNum].$children,e=this.resultArr[this.subjectNum-1],i=(t[0].text==e[0]||"2x"==t[0].text)&&t[1].text==e[1],r=t[0].text==e[1]&&(t[1].text==e[0]||"2x"==t[1].text);"4年前小东"==this.setInput.text?this.submitArr[this.subjectNum-1][0]=!0:this.submitArr[this.subjectNum-1][0]=!1,i||r?this.submitArr[this.subjectNum-1][1]=!0:this.submitArr[this.subjectNum-1][1]=!1,t[2].text==e[2]?this.submitArr[this.subjectNum-1][2]=!0:this.submitArr[this.subjectNum-1][2]=!1,t[3].text==e[3]?this.submitArr[this.subjectNum-1][3]=!0:this.submitArr[this.subjectNum-1][3]=!1},e.prototype.commitFun=function(){var t=this;console.log(this.particleArr),-1==this.submitArr[this.subjectNum-1].indexOf(!1)?(this.submitArr[this.subjectNum-1].map(function(e,i){t.fireAnimation("saicheweibu01_png","saicheweibu01_json",i)}),this.racGo.play(0),this.playMusic("rac_go"),setTimeout(function(){t.gameoverFun()},3100)):(this.removeParticle(),this.submitArr[this.subjectNum-1].map(function(e,i){setTimeout(function(){t.playMusic("rac_error")},300),e?t.fireAnimation("fire_png","fire_json",i):t.mistAnimation(i)}))},e.prototype.removeParticle=function(){var t=this;this.rac_position.x=33,this.particleArr.map(function(e,i){e&&(t["rac"+(i+1)].removeChild(e),t.particleArr[i]=void 0)})},e.prototype.gameoverFun=function(){var t=this;this.gameover.visible=!0,this.opacity.play(0),this.playMusic("rac_go_stop"),setTimeout(function(){var e={dragonbonesData:"rac_ske_json",textureData1:"rac_tex_json",texture1:"rac_tex_png",name:"MovieClip"};t.pokeAnimation(e)},1500)},e.prototype.recommence=function(){var t=this;0!=this.overAnimationArr.length&&(this.gameover.visible=!1,this.showFong.alpha=1,this.overAnimationArr.map(function(e,i){t.removeChild(e)}),this.overAnimationArr=[],this.armature&&(this.gameover.removeChild(this.armature.getDisplay()),this.armature=void 0),this.reviseLabelText(),this.musicFun())},e.prototype.musicFun=function(){this.isMusic?(this.music_bj.stop(),this.isMusic=!1,this.music.source="music_close_png"):(this.music_bj=this.rac_bj.play(0,-1),this.isMusic=!0,this.music.source="music_png")},e.prototype.reviseFun=function(){window.location.reload()},e.prototype.playMusic=function(t,e){void 0===e&&(e=1),this.racTipMusic&&this.racTipMusic.stop(),this.racTipMusic=this[t].play(0,e)},e}(eui.Component);__reflect(Racing.prototype,"Racing",["eui.UIComponent","egret.DisplayObject"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,r){function s(t){e.call(r,t)}function n(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(r))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var u=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(u,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(r,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var keySet=function(t){function e(e,i,r){var s=t.call(this)||this;return s.skinName="keySetSkin",s.keySet=e,s.keysetGroup.x=i,s.keysetGroup.y=r,s.first=!0,s}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.keySetFun()},e.prototype.keySetFun=function(){this.keyDown.touchChildren=!0,this.keyDown.addEventListener(egret.TouchEvent.TOUCH_TAP,this.keyDownFun,this),this.keyOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.closeKeySet.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.keyRevise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this)},e.prototype.keyDownFun=function(t){if(this.first&&(this.first=!1,this.keySet.clickLabel.text=""),!t.target.$Group&&this.keySet.clickLabel.text.length<7){var e=t.target.source.split("_")[0].split("key").reverse()[0];this.keySet.clickLabel.text+=e}},e.prototype.reviseFun=function(t){this.keySet.clickLabel.text=""},e.prototype.submitFun=function(t){""==this.keySet.clickLabel.text&&(this.keySet.clickLabel.text="输入"),this.keySet.removeChild(this)},e}(eui.Component);__reflect(keySet.prototype,"keySet",["eui.UIComponent","egret.DisplayObject"]);