var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(s,r){function o(t){try{c(n.next(t))}catch(e){r(e)}}function a(t){try{c(n["throw"](t))}catch(e){r(e)}}function c(t){t.done?s(t.value):new i(function(e){e(t.value)}).then(o,a)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(s)throw new TypeError("Generator is already executing.");for(;c;)try{if(s=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(n){i=[6,n],r=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Dinosaur=function(t){function e(){var e=t.call(this)||this;return e.RecNum=1,e.Rec1=[["输入","输入","输入"],["输入","8","6"],["9","输入","输入"]],e.Rec2=[["输入","12","输入"],["输入","输入","20"],["16","输入","11"]],e.Rec3=[["输入","35","89"],["1","输入","输入"],["输入","输入","输入"]],e.RecResult=[[[5,12,7],[10,8,6],[9,4,11],[24]],[[19,12,14],[10,15,20],[16,18,11],[45]],[[194,35,89],[1,106,211],[123,177,18],[318]]],e.egretFactory=dragonBones.EgretFactory.factory,e.step=0,e.kl_bj=RES.getRes("kl_bj_mp3"),e.kl_tip=RES.getRes("kl_tip_mp3"),e.kl_egg_l=RES.getRes("kl_egg_l_mp3"),e.kl_up=RES.getRes("kl_up_mp3"),e.kl_chi=RES.getRes("kl_chi_mp3"),e.kl_chi_2=RES.getRes("kl_chi_2_mp3"),e.kl_error=RES.getRes("kl_error_mp3"),e.isMusic=!0,e.addEventListener(egret.Event.ENTER_FRAME,function(){dragonBones.WorldClock.clock.advanceTime(.03)},e),e.skinName="DinosaurSkin",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.startGroupe.visible=!0,this.startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.start()},this)},e.prototype.start=function(){var t=this;this.startGroupe.visible=!1,this.subjectTip.touchChildren=!1,this.subjectTip.visible=!1,this.RecNum=1,this.step=0,this.egg.visible=!0,this.music_bj=this.kl_bj.play(0,-1),this.kl_tip.play(0,1),console.log(this.music),this.next.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextFun,this),this.previous.addEventListener(egret.TouchEvent.TOUCH_TAP,this.previousFun,this),this.labelSum.addEventListener(egret.TouchEvent.TOUCH_TAP,this.labelSumFun,this),this.cacl.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickCaclFun,this),this.tip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tipFun,this),this.tipGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.tipGroup.visible=!1},this),this.revise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.music.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicFun,this),this.subject.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.subjectTip.visible=!0},this),this.subjectTip.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.subjectTip.visible=!1},this),this.recFun()},e.prototype.clickCaclFun=function(){this.addChild(new cacl(this))},e.prototype.nextFun=function(){this.targetFun(),this.RecNum+=1,this.recFun(),this.previous.visible=!0,this.next.visible=this.RecNum>=3?!1:!0},e.prototype.previousFun=function(){this.targetFun(),this.RecNum-=1,this.recFun(),this.next.visible=!0,this.previous.visible=this.RecNum<=1?!1:!0},e.prototype.targetFun=function(){this.step=0,this.egg.source="egg_png",this.egg.visible=!0,console.log(this.poke),this.poke&&(this.pokrGroup.removeChild(this.poke.getDisplay()),this.poke=void 0)},e.prototype.tipFun=function(){this.tipImage.source="rectangle0"+this.RecNum+"_png",this.tipGroup.visible=!0},e.prototype.clickStone=function(t){this.clickLabel=t.target,this.RecPosition=t.target.name;var e=t.target.parent.x+t.target.x,i=t.target.parent.y+t.target.y;console.log(e,i),this.addChild(new Keyset(this,e-500,i-200))},e.prototype.labelSumFun=function(t){this.clickLabel=t.target,this.RecPosition={i:3,j:0},this.addChild(new Keyset(this,t.target.x,t.target.y+100))},e.prototype.inspectLabel=function(){console.log("输入:"+this.clickLabel.text,"坐标：",this.RecPosition);var t=this.RecResult[this.RecNum-1][this.RecPosition.i][this.RecPosition.j];console.log("正确答案：",t),t==this.clickLabel.text?(this.RecPosition.i>=3?"":this["stone"+this.RecPosition.i+this.RecPosition.j].source="stone01_png",this.stepPlay()):(this.RecPosition.i>=3?"":this["stone"+this.RecPosition.i+this.RecPosition.j].source="clickStone01_png",this.stepPlayError())},e.prototype.stepPlay=function(){switch(console.log(this.step),this.step){case 0:this.egg.source="egg1_png",this.kl_egg_l.play(0,1);break;case 1:this.egg.source="egg2_png",this.kl_egg_l.play(0,1);break;case 2:this.kl_up.play(0,1),this.dbObj={dragonbonesData:"poke_ske_json",textureData1:"poke_tex_json",texture1:"poke_tex_png",name:"Sprite"},this.egg.visible=!1,this.pokeAnimation();break;default:var t=Math.ceil(4*Math.random());this.kl_chi.play(0,1),this.dbObj={dragonbonesData:"chi"+t+"_ske_json",textureData1:"chi"+t+"_tex_json",texture1:"chi"+t+"_tex_png",name:"Chi"+t},this.heartAnimation(),this.pokeAnimation()}this.step++},e.prototype.stepPlayError=function(){this.kl_error.play(0,1),this.step>2?(this.dbObj={dragonbonesData:"tanqi_ske_json",textureData1:"tanqi_tex_json",texture1:"tanqi_tex_png",name:"Tanqi"},this.pokeAnimation()):this.lineAnimation()},e.prototype.recFun=function(){for(var t=this["Rec"+this.RecNum],e=0;e<t.length;e++)for(var i=0;i<t[e].length;i++)"输入"==t[e][i]?(this["label"+e+i].textColor="D4670D",this["stone"+e+i].source="clickStone01_png",this["label"+e+i].name={i:e,j:i},this["label"+e+i].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStone,this)):(this["label"+e+i].textColor="635F39",this["stone"+e+i].source="stone01_png"),this["label"+e+i].text=t[e][i];this.labelSum.text="点击输入"},e.prototype.pokeAnimation=function(){this.poke&&this.pokrGroup.removeChild(this.poke.getDisplay()),console.log(this.dbObj);var t=RES.getRes(this.dbObj.dragonbonesData),e=RES.getRes(this.dbObj.textureData1),i=RES.getRes(this.dbObj.texture1);this.egretFactory.parseDragonBonesData(t),this.egretFactory.parseTextureAtlasData(e,i),this.poke=this.egretFactory.buildArmature(this.dbObj.name);var n=this.poke.getDisplay();this.pokrGroup.addChild(n),n.x=465,n.y=500,this.poke.animation.gotoAndPlayByFrame(this.dbObj.name,1,1).timeScale=.5,dragonBones.WorldClock.clock.add(this.poke),this.poke.addEventListener(dragonBones.EventObject.COMPLETE,function(t){console.log("-->",t.target.animation.animationDataList),this.poke.animation.gotoAndStopByProgress(this.dbObj.name,1)},this)},e.prototype.lineAnimation=function(){var t=RES.getRes("heixian_json"),e=RES.getRes("heixian_png"),i=new egret.MovieClipDataFactory(t,e),n=new egret.MovieClip(i.generateMovieClipData("heixian"));this.wrong.addChild(n),n.play(1),n.addEventListener(egret.Event.COMPLETE,function(){console.log("播放完成"),this.wrong.removeChild(n)},this)},e.prototype.heartAnimation=function(t,e){var i=this;void 0===t&&(t=450),void 0===e&&(e=300);var n=RES.getRes("taoxin02_png"),s=RES.getRes("taoxin02_json"),r=new particle.GravityParticleSystem(n,s);this.addChildAt(r,5),r.x=t,r.y=e,r.start(),this.kl_chi_2.play(0,1).addEventListener(egret.Event.SOUND_COMPLETE,function(){i.removeChild(r)},this)},e.prototype.musicFun=function(){this.isMusic?(this.music_bj.stop(),this.isMusic=!1,this.music.source="music_close_png"):(this.music_bj=this.kl_bj.play(0,-1),this.isMusic=!0,this.music.source="music_png")},e.prototype.reviseFun=function(){window.location.reload()},e}(eui.Component);__reflect(Dinosaur.prototype,"Dinosaur",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),this.startAnimation(t),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=new Dinosaur;this.addChild(t)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,n=t.map(function(t){return i.parse(t)}),s=this.textfield,r=-1,o=function(){r++,r>=n.length&&(r=0);var t=n[r];s.textFlow=t;var i=egret.Tween.get(s);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(o,e)};o()},e.prototype.onButtonClick=function(t){var e=new eui.Panel;e.title="Title",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var c=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(c,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var cacl=function(t){function e(e){var i=t.call(this)||this;return i.value=0,i.towValue=0,i.valueArr=[],i.typeArr=[],i.count=0,i.submitNum=0,i.skinName="caclSkin",i.cacl=e,i}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.start()},e.prototype.start=function(){var t=this;this.caclGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.keyDown,this),this.add.addEventListener(egret.TouchEvent.TOUCH_TAP,this.addFun,this),this.minus.addEventListener(egret.TouchEvent.TOUCH_TAP,this.minusFun,this),this.ride.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rideFun,this),this.remove.addEventListener(egret.TouchEvent.TOUCH_TAP,this.removeFun,this),this.ac.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickAC,this),this.submit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.closeCacl.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.cacl.removeChild(t)},this)},e.prototype.keyDown=function(t){"="==this.typeArr[this.typeArr.length-1]&&this.settingValue(),this.sum0.visible=!1;var e=t.target.source.split("_")[0].split("cacl")[1];this.sum.text=parseInt(this.sum.text+e)+"",this.value=parseInt(this.value+e)},e.prototype.settingValue=function(){this.submitNum<1&&(this.value=0,this.submitNum+=1)},e.prototype.addFun=function(){this.computed("+")},e.prototype.minusFun=function(){this.computed("-")},e.prototype.rideFun=function(){this.computed("x")},e.prototype.removeFun=function(){this.computed("÷")},e.prototype.clickAC=function(){this.sum.text="0",this.sum0.text="0",this.sum0.visible=!1,this.value=0,this.count=0,this.typeArr=[]},e.prototype.submitFun=function(){this.computed("="),this.value=parseInt(this.sum0.text),this.submitNum=0,this.count=0},e.prototype.computed=function(t){this.valueArr.push(this.value),this.typeArr.push(t);var e=0,i=parseInt(this.sum0.text);if(console.log("-->",this.count),this.count>=1){switch(this.towValue=this.value,this.typeArr[this.typeArr.length-2]){case"+":e=i+this.towValue;break;case"-":e=i-this.towValue;break;case"x":e=i*this.towValue;break;case"÷":e=i/this.towValue}this.sum0.text=e+""}else console.log("初始化"),this.sum0.text=this.value+"";this.sum.text="",this.sum0.visible=!0,this.value=0,this.count++},e}(eui.Component);__reflect(cacl.prototype,"cacl",["eui.UIComponent","egret.DisplayObject"]);var Keyset=function(t){function e(e,i,n){var s=t.call(this)||this;return s.skinName="KeysetSkin",s.cacl=e,s.x=0,s.y=0,s.keySetGroup.x=i,s.keySetGroup.y=n,s}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);for(var e=0;10>e;e++)this["key"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickKeyFun,this);this.cacl.clickLabel.text="",this.keyRevise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.keyOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.RectBj.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this)},e.prototype.clickKeyFun=function(t){var e=t.target.source.split("_")[0];this.cacl.clickLabel.text.length<4&&(this.cacl.clickLabel.text+=e.split("key")[1])},e.prototype.reviseFun=function(t){this.cacl.clickLabel.text=""},e.prototype.submitFun=function(t){""!=this.cacl.clickLabel.text?this.cacl.clickLabel.text=parseInt(this.cacl.clickLabel.text)+"":this.cacl.clickLabel.text="输入",this.cacl.inspectLabel(),this.cacl.removeChild(this)},e}(eui.Component);__reflect(Keyset.prototype,"Keyset",["eui.UIComponent","egret.DisplayObject"]);