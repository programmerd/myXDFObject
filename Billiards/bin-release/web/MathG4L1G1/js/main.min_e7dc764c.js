var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(s,r){function o(t){try{u(n.next(t))}catch(e){r(e)}}function a(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?s(t.value):new i(function(e){e(t.value)}).then(o,a)}u((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(s)throw new TypeError("Generator is already executing.");for(;u;)try{if(s=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(o=u.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(n){i=[6,n],r=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,r,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Billiards=function(t){function e(){var e=t.call(this)||this;return e.isPosAndNum="number",e.isFirst=!0,e.egretFactory=dragonBones.EgretFactory.factory,e.file={dom:"taiqiu",dragonbonesData:"taiqiu_ske_json",textureData1:"taiqiu_tex_json",texture1:"taiqiu_tex_png",name:"taiqiu",count:1},e.over={dom:"taiqiuOver",dragonbonesData:"taiqiujieshu_ske_json",textureData1:"taiqiujieshu_tex_json",texture1:"taiqiujieshu_tex_png",name:"taiqiujieshu",count:1},e.switchSum={dom:"sumGroup",dragonbonesData:"shuzigundong_ske_json",textureData1:"shuzigundong_tex_json",texture1:"shuzigundong_tex_png",name:"shuzigundong",count:8},e.switchRow={dom:"rowGroup",dragonbonesData:"shuzigundong_ske_json",textureData1:"shuzigundong_tex_json",texture1:"shuzigundong_tex_png",name:"shuzigundong",count:8},e.switchNum={dom:"numGroup",dragonbonesData:"shuzigundong_ske_json",textureData1:"shuzigundong_tex_json",texture1:"shuzigundong_tex_png",name:"shuzigundong",count:8},e.guangxian01={dom:"guangshu",dragonbonesData:"guangxian01_ske_json",textureData1:"guangxian01_tex_json",texture1:"guangxian01_tex_png",name:"guangxian01",count:-1},e.yanhua01={dom:"successGroup",dragonbonesData:"yanhua01_ske_json",textureData1:"yanhua01_tex_json",texture1:"yanhua01_tex_png",name:"yanhua01",count:-1},e.isMusic=!0,e.tq_bj=RES.getRes("tq_bj_mp3"),e.tq_click=RES.getRes("tq_click_mp3"),e.tq_error=RES.getRes("tq_error_mp3"),e.tq_success=RES.getRes("tq_success_mp3"),e.tq_fg=RES.getRes("tq_fg_mp3"),e.tq_fz=RES.getRes("tq_fz_mp3"),e.tq_ok=RES.getRes("tq_ok_mp3"),e.tq_mc=RES.getRes("tq_mc_mp3"),e.tq_pp_error1=RES.getRes("tq_pp_error1_mp3"),e.tq_pp_error2=RES.getRes("tq_pp_error2_mp3"),e.tq_ppcg=RES.getRes("tq_ppcg_mp3"),e.tq_tip=RES.getRes("tq_tip_mp3"),e.skinName="BilliardsSkin",e.addEventListener(egret.Event.ENTER_FRAME,function(){dragonBones.WorldClock.clock.advanceTime(.03)},e),e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.music.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicFun,this),this.revise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.taiqiu2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickTaiQiu,this),this.subject.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showTipFun,this),this.showTip.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.showTip.visible=!1,e.playMusic("tq_ok")},this),this.clickNumber.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickInputFun,this),this.clickPosition.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickInputFun,this),this.clickOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickOkFun,this),this.successGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseSub,this),this.loseGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.newlySub,this),this.clickStart.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.endStart.visible=!1,e.start()},this)},e.prototype.start=function(){this.reviseSub(),this.music_bj=this.tq_bj.play(0,-1),this.hand=this.fireAnimation("shouzhi_json","shouzhi_png","heand")},e.prototype.showTipFun=function(){this.playMusic("tq_tip"),this.showTip.visible=!0},e.prototype.clickTaiQiu=function(){console.log("点击"),this.playMusic("tq_fz"),this.taiqiu2.visible=!1,this.animationFun(this.file),this.hand=this.fireAnimation("shouzhi_json","shouzhi_png","heand",250,580)},e.prototype.reviseSub=function(){this.playMusic("tq_tip");var t=this.clickPosition.$children,e=this.clickNumber.$children;t.map(function(t){t.text="输入"}),e.map(function(t){t.text="输入"}),this.overAnimate?this.guangshu.removeChild(this.overAnimate):"",this.overAnimate2?this.successGroup.removeChild(this.overAnimate2):"",this.writeNumber.source="number1_png",this.writePosition.source="position1_png",this.clickOk.enabled=!1,this.resultGroup.visible=!1,this.successGroup.visible=!1,this.loseGroup.visible=!1,this.taiqiuOver.visible=!1,this.textRow.text="",this.textNum.text="",this.textSum.text=""},e.prototype.newlySub=function(){this.clickOk.enabled=!1,this.resultGroup.visible=!1,this.successGroup.visible=!1,this.loseGroup.visible=!1,this.taiqiuOver.visible=!1,this.textRow.text="",this.textNum.text="",this.textSum.text=""},e.prototype.testAndVerify=function(){var t=this,e=this.clickPosition.$children,i=this.clickNumber.$children;console.log("判断"),"number"==this.isPosAndNum?i.map(function(e,i){"输入"==e.text||"重新输入"==e.text?t.clickOk.enabled=!1:t.clickOk.enabled=!0}):e.map(function(e){"输入"==e.text||"重新输入"==e.text?t.clickOk.enabled=!1:t.clickOk.enabled=!0}),this.clickOk.enabled&&(e[1].text=e[1].text>=2*e[0].text-1?2*e[0].text-1:e[1].text,i[2].text=i[2].text>=2*i[1].text-1?2*i[1].text-1:i[2].text,this.hand=this.fireAnimation("shouzhi_json","shouzhi_png","heand",950,1080),this.isFirst=!1)},e.prototype.clickInputFun=function(t){if("group"!=t.target.name){this.playMusic("tq_click"),this.hand.parent?this.removeChild(this.hand):"",this.clickLabel=t.target,this.isPosAndNum=t.target.name;var e=0,i=t.target.parent.y-400;"number"==t.target.name?(this.writeNumber.source="number1_png",this.writePosition.source="position2_png",e=t.target.parent.x-150):(this.writePosition.source="position1_png",this.writeNumber.source="number2_png",e=t.target.parent.x-100),this.addChild(new Keyset(this,e,i))}},e.prototype.clickOkFun=function(){this.tq_ok.play(0,1),this.hand.parent?this.removeChild(this.hand):"",this.resultGroup.visible=!0,"number"==this.isPosAndNum?(this.textSum.text=this.inputNum.text,this.textRow.textColor=16711680,this.textNum.textColor=16711680,this.textSum.textColor=11159553,this.inputLabel=this.textRow,this.valueRow=Math.floor(Math.sqrt(parseInt(this.textSum.text)-1))+1,this.valueNum=2*this.valueRow-1-(Math.pow(this.valueRow,2)-parseInt(this.textSum.text)),this.animationFun(this.switchRow),this.animationFunTow(this.switchNum),console.log(this.valueRow,this.valueNum)):(this.textRow.text=this.inputPos1.text,this.textNum.text=this.inputPos2.text,this.textRow.textColor=11159553,this.textNum.textColor=11159553,this.textSum.textColor=16711680,this.inputLabel=this.textSum,this.valueSum=Math.pow(parseInt(this.textRow.text),2)-(2*parseInt(this.textRow.text)-1-parseInt(this.textNum.text)),console.log(this.valueSum),this.animationFun(this.switchSum))},e.prototype.fireAnimation=function(t,e,i,n,s){void 0===n&&(n=950),void 0===s&&(s=500),this.hand&&this.hand.parent&&this.removeChild(this.hand);var t=RES.getRes(t),e=RES.getRes(e),r=new egret.MovieClipDataFactory(t,e),o=new egret.MovieClip(r.generateMovieClipData(i));return this.isFirst?this.addChild(o):"",o.play(-1),o.x=n,o.y=s,o.addEventListener(egret.Event.COMPLETE,function(){this.removeChild(this.hand),console.log("播放完成")},this),o},e.prototype.animationFun=function(t){this.armature&&this.armature.parent&&this[t.dom].removeChild(this.armature.getDisplay());var e=RES.getRes(t.dragonbonesData),i=RES.getRes(t.textureData1),n=RES.getRes(t.texture1);this.egretFactory.parseDragonBonesData(e),this.egretFactory.parseTextureAtlasData(i,n),this.armature=this.egretFactory.buildArmature(t.name);var s=this.armature.getDisplay();"taiqiu"==t.name?(this.taiqiu.visible=!0,s.x=929,s.y=428):"shuzigundong"==t.name?(this.playMusic("tq_fg"),s.x=16,s.y=9):"taiqiujieshu"==t.name&&(this.playMusic("tq_mc"),this.musicFun(),s.x=960,s.y=540),this[t.dom].addChild(s),this.armature.animation.gotoAndPlayByFrame(t.name,1,t.count).timeScale=1,dragonBones.WorldClock.clock.add(this.armature),this.armature.addEventListener(dragonBones.EventObject.COMPLETE,function(e){var i=this;console.log("动画播放完成"),this[t.dom].removeChild(this.armature.getDisplay()),"taiqiu"==t.name?(this.taiqiu1.visible=!0,this.taiqiu.visible=!1):"shuzigundong"==t.name?("number"==this.isPosAndNum?this.inputLabel.text=this.valueRow+"":this.inputLabel.text=this.valueSum+"",setTimeout(function(){i.estimateFun()},1e3)):"taiqiujieshu"==t.name&&(this.taiqiuOver.visible=!1,this.successGroup.visible=!0,this.playMusic("tq_success"),this.musicFun()),this.armature=void 0},this)},e.prototype.animationFunTow=function(t){var e=this,i=RES.getRes(t.dragonbonesData),n=RES.getRes(t.textureData1),s=RES.getRes(t.texture1),r=new dragonBones.EgretFactory;r.parseDragonBonesData(i),r.parseTextureAtlasData(n,s);var o=r.buildArmatureDisplay(t.name);return this[t.dom].addChild(o),"yanhua01"==t.name&&(o.x=900,o.y=500,o.scaleX=2,o.scaleY=2),o.animation.gotoAndPlayByFrame(t.name,1,t.count),o.addEventListener(dragonBones.EventObject.COMPLETE,function(){e[t.dom].removeChild(o),e.textNum.text=e.valueNum+""},this),o},e.prototype.estimateFun=function(){var t=this,e=!1;setTimeout(function(){t.resultGroup.visible=!1},1e3),"number"==this.isPosAndNum?this.valueRow==parseInt(this.inputNum1.text)&&this.valueNum==parseInt(this.inputNum2.text)?(console.log("恭喜"),e=!0):(this.inputNum1.text="重新输入",this.inputNum2.text="重新输入",console.log("失败"),e=!1):this.valueSum==parseInt(this.inputSum.text)?(console.log("恭喜"),e=!0):(this.inputSum.text="重新输入",console.log("失败"),e=!1),e?(this.playMusic("tq_ppcg"),setTimeout(function(){t.successFun()},1e3)):(this.playMusic("tq_pp_error2"),setTimeout(function(){t.loseGroup.visible=!0,t.lose.play(0),t.playMusic("tq_error")},1e3))},e.prototype.successFun=function(){this.taiqiuOver.visible=!0,this.animationFun(this.over),this.overAnimate=this.animationFunTow(this.guangxian01),this.overAnimate2=this.animationFunTow(this.yanhua01)},e.prototype.musicFun=function(){this.isMusic?(this.music_bj.stop(),this.isMusic=!1,this.music.source="music_close_png"):(this.music_bj=this.tq_bj.play(0,-1),this.isMusic=!0,this.music.source="music_png")},e.prototype.reviseFun=function(){window.location.reload()},e.prototype.playMusic=function(t,e){return void 0===e&&(e=1),this.racTipMusic&&this.racTipMusic.stop(),this.racTipMusic=this[t].play(0,e),this.racTipMusic},e}(eui.Component);__reflect(Billiards.prototype,"Billiards",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.size=80,this.textField.y=300,this.textField.width=1920,this.textField.height=200,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="正在加载..."+Math.floor(t/e*100)+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),this.startAnimation(t),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=new Billiards;this.addChild(t)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,n=t.map(function(t){return i.parse(t)}),s=this.textfield,r=-1,o=function(){r++,r>=n.length&&(r=0);var t=n[r];s.textFlow=t;var i=egret.Tween.get(s);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(o,e)};o()},e.prototype.onButtonClick=function(t){var e=new eui.Panel;e.title="Title",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var u=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(u,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Keyset=function(t){function e(e,i,n){var s=t.call(this)||this;return s.skinName="KeysetSkin",s.cacl=e,s.x=0,s.y=0,console.log(i,n),s.keySetGroup.x=i,s.keySetGroup.y=n,s}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);for(var e=0;10>e;e++)this["key"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickKeyFun,this);this.cacl.clickLabel.text="",this.keyRevise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.keyOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.RectBj.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this)},e.prototype.clickKeyFun=function(t){var e=t.target.source.split("_")[0];this.cacl.clickLabel.text.length<8&&(this.cacl.clickLabel.text+=e.split("key")[1])},e.prototype.reviseFun=function(t){this.cacl.clickLabel.text=""},e.prototype.submitFun=function(t){""!=this.cacl.clickLabel.text?this.cacl.clickLabel.text=parseInt(this.cacl.clickLabel.text)+"":this.cacl.clickLabel.text="输入",this.cacl.testAndVerify(),this.cacl.removeChild(this)},e}(eui.Component);__reflect(Keyset.prototype,"Keyset",["eui.UIComponent","egret.DisplayObject"]);